---
title: 搜索引擎系列
---

## 概述

Elasticsearch 是一款非常强大的开源搜索引擎和大数据搜索的平台，开源从海量数据中快速找到相应的内容，比如 github 搜索，打车时定位乘客和司机。
除了搜索，结合 Kibana、Logstash、Beats，Elastic Stack
还被广泛使用在大数据近实时分析领域，包括日志分析、指标监控，信息安全等多个领域。可以帮助我们探索海量的结构化的、非结构化的数据，按需创建可视化的报表，对监控数据设置报警阈值，及时发出异常警报。

![](https://img.wkq.pub/hexo/image-20220907192958697.png)

* 主要功能
  * 分布式搜索引擎
  * 大数据近实时分析引擎
* 产品特性
  * 高性能
  * 容易使用 / 容易扩展，支持水平扩展

## Elasticsearch的分布式架构

![es的分布式架构](https://img.wkq.pub/hexo/image-20220907193719121.png)

* 集群规模可以从单个节点扩展至数百个节点
* 高可用 & 水平扩展
  * 服务和数据两个纬度
* 支持不同的节点类型
  * 支持 Hot & Warm 架构

## 支持多种方式集成接入

* 多种编程语言的类库，Java / .NET / Python /Ruby /PHP / Groovy / Perl
* RESTful API vs Transport API
  * 9200 vs  9300 
* JDBC & ODBC

## Elasticsearch 的主要功能

* 海量数据的分布式存储以及集群管理
  * 服务与数据的高可用，水平扩展
* 近实时搜索，性能卓越
  * 结构化 / 全文 / 地理位置 /自动完成
* 海量数据的近实时分析
  * 聚合功能

## Elastic Stack 生态圈

![](https://img.wkq.pub/hexo/elasticsearch生态圈.png)

### Logstash：数据处理管道

* 开源的服务器端数据处理管道，支持从不同来源采集数据，转换数据，并将数据发送到不同的存储库中。
* Logstash 诞生于 2009 年，最初用来做日志的采集与处理
* 2013 年被 Elasticsearch 收购

#### 特性

* 实时解析和转换地址
  * 从 IP 地址破译出地理坐标
  * 将 PII 数据匿名化，，完全排除敏感字段
* 可扩展
  * 200 多个插件（日志/数据库 /Arcsigh/Netflow）
* 可靠安全性
  * Logstash 会通过持久化队列来保证至少将运行中的事件发送一次
  * 数据传输加密
* 监控

### Kibana：可视化分析利器

* Kibana 名字含义 = Kiwifruit + Banana
* 数据可视化工具，帮助用户解开对数据的任何疑问
* 基于 Logstash 的工具，2013 年加入 Elastic 公司

### Beats：轻量的数据采集器

![Beats：轻量的数据采集器](https://img.wkq.pub/hexo/image-20220907195454672.png)

### ELK应用场景

* 网站搜素 / 垂直搜索 / 代码搜索
* **日志管理与分析** / **安全指标监控** / 应用性能监控 / WEB 抓取舆情分  

#### 日志管理

* 流程：日志搜集 → 格式化分析 → 全文检索 → 风险告警
* 假如运维是医生，日志就是病人对自己病情的陈述

## Elasticsearch 与数据库的集成

![image-20220907200647880](https://img.wkq.pub/hexo/image-20220907200647880.png)

* 单独使用 ELasticsearch 存储，这种情况架构会变得非常简单；但如果数据的更新非常频繁，另外需要考虑事务性的情况下，还是需要将应用数据先写入数据库，再使用同步机制，将数据同步到 ES 中。
* 以下情况可考虑与数据库集成
  * 与现有系统的集成
  * 需要考虑事务性
  * 数据更新频繁

## 指标分析/日志分析

![image-20220907201050183](https://img.wkq.pub/hexo/image-20220907201050183.png)



