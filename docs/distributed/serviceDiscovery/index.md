---
title: 服务发现
description: 服务发现的意义是解决程序对服务位置的依赖
---
## 概述
微服务架构中的一个重要设计原则是“通过服务来实现独立自治的组件”。类库跟服务有很大区别，类库是在编译器静态链接到程序中的，通过本地调用来提供功能；而服务是进程外组件，通过远程调用来提供功能。

服务发现是将固定的代表服务的标识符转化为动态的真正的服务地址，并持续维护这些地址在动态运维过程中的时效性。因此，为了完成这个目标，服务发现需要解决注册、维护、发现三大功能问题，并且需要权衡分布式环境下一致性和可用性之间的矛盾。


而服务发现的意义是解耦程序对服务具体位置的依赖，对于分布式应用来讲，服务发现不是可选项，而是必须的。

:::tip 

服务发现是整个系统中，其它所有服务都直接依赖的最基础的服务（类似相同待遇的就要数配置中心了，Nacos 也提供配置中心，避免配置中心又搞出一套集群出来）。服务注册中心一旦崩溃，整个系统都会受到波及和影响，因此必须在技术层面保证注册中心的可用性。

:::

## 服务发现要解决注册、维护和发现三大功能问题

### 服务的注册
当服务启动的时候，它应该通过某种形式（比如调用 API），把自己的坐标信息通过给服务注册中心，这个过程可能由应用程序自己完成（比如SpringCloud 的 @EnableDiscoveryClient 注解），也可能是容器框架（比如 Kubernetes ）来完成.

### 服务的维护
为了防止由于宕机、断网等原因导致服务失联，服务发现框架就必须要自己去保证所维护的服务列表的正确性，以避免告知消费者服务的坐标后，得到的服务却不能使用的情况。

服务发现框架一般通过 长连接、心跳、探针、进程状态等，来监控服务是否健康存活，然后把不健康的服务自动下线。
### 服务的发现
这里的服务发现特指服务消费者从服务发现框架中，把一个符号(比如 Eureka、Nacos中的 ServiceID)转换成服务实际坐标地址的过程，一般通过 HTTP API 请求的方式。